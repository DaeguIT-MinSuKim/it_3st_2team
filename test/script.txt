INSERT INTO event (evnNo,evnName,discount) VALUES  
 (1,'기획',0.5), 
 (2,'생일',0.3), 
 (3,'조조',0.2), 
 (4,'어린이',0.6),
 (5,'일반',1.0);
 select * from event; 
  
INSERT INTO hair (hairNum,hairName,price,pic) VALUES  
 (1,'커트',15000,null), 
 (2,'드라이',12000,null), 
 (3,'샴푸',5000,null), 
 (4,'펌',38500,null), 
 (5,'매직',95000,null), 
 (6,'트리트먼트',35000,null), 
 (7,'앰플',18000,null), 
 (8,'기타',16000,null); 
 select * from hair; 
  
insert into employee (empNo, empName, title, joinDate, addr, id, password) values 
(1,'직원1','사장','2011-01-02',null,'idemp1','pwemp1'), 
(2,'직원2','이사','2012-05-01',null,'idemp2','pwemp2'), 
(3,'직원3','실장','2015-06-30',null,'idemp3','pwemp3'), 
(4,'직원4','매니저','2016-10-20',null,'idemp4','pwemp4'), 
(5,'직원5','인턴','2017-11-01',null,'idemp5','pwemp5'); 
select * from employee; 

insert into customer (cusNo, cusName, birth, age, joinDate, phone, gender, pic, addr, empNo) values 
(1,'고객1','1990-02-20',null,'2001-05-10','010-1111-1111',0,null,'서울시 서초구 서초동',2), 
(2,'고객2','1992-09-09',null,'2000-03-02','010-2222-2222',1,null,'경기도 영통구 천천동',1), 
(3,'고객3','1987-06-01',null,'2001-08-08','010-3333-3333',0,null,'경산시 정평동',3), 
(4,'고객4','1990-10-11',null,'2001-08-02','010-4444-4444',1,null,'대구시 북구 반월동',5); 
select * from customer; 

insert into eoff (empNo,eoffDay) values 
(1,'2018-02-20'), 
(1,'2018-02-21'), 
(1,'2018-02-22'), 
(2,'2018-03-01'), 
(2,'2018-03-02'), 
(3,'2018-02-27'), 
(4,'2018-02-25'); 
select * from eoff; 

/*트리거 만들기*/
create trigger discount_price
before insert on sale 
for each row  
begin 
declare x int; 
declare y float; 
set x =(select h.price from hair h join sale s on h.hairNum=s.hairNum); 
set y =(select e.discount from event e join sale s on s.evnNo=e.evnNo); 
set new.sprice=(x*y); 
end

select * from sale;
/*순서1. 트리거 적용전 insert. sprice가 null인 데이터 추가*/
insert into sale (saleNo, description, date, time, state, sprice, cusNo, empNo, hairNum, evnNo) values 
(1,null,'2000-05-10','11:00:00',0,null,3,1,5,1);  
/*순서2. 트리거 적용 후 insert. sprice를 null로 입력하였지만 할인 후 적용가로 들어간 것을 확인해야함*/
insert into sale (saleNo, description, date, time, state, sprice, cusNo, empNo, hairNum, evnNo) values 
(2,null,'2000-05-10','11:00:00',0,null,3,1,5,1); 
delete from sale where saleNo=2; 

/*그냥 해본 테스트들..(필요하면 참고하세요)*/
select c.cusName, s.empNo as '담당직원', s.evnNo, s.hairNum, h.price, e.discount, (h.price*e.discount) as '할인적용가' from customer c join sale s on c.cusNo=s.cusNo 
left join hair h on s.hairNum=h.hairNum 
left join event e on s.evnNo=e.evnNo; 
select h.price from hair h join sale s on h.hairNum=s.hairNum; 
select e.discount from event e join sale s on s.evnNo=e.evnNo; 
select discount from event where evnNo=1; 

/*트리거 만들때 연습용으로 해봄..*/
create trigger discount_price 
before insert on sale 
for each row  
begin 
declare x int; 
declare y int; 
set x=10000; 
set new.sprice = x; 
end  



  